// Generated by CoffeeScript 1.7.1
$('#device_register_list').dataTable({
  "aoColumns": [
    {
      "bSortable": false
    }, null, null, null, null, null, {
      "bSortable": false
    }
  ],
  "oLanguage": {
    "sLengthMenu": "每页显示 _MENU_ 条记录",
    "sZeroRecords": "抱歉， 没有找到",
    "sInfo": "从 _START_ 到 _END_ /共 _TOTAL_ 条数据",
    "sInfoEmpty": "没有数据",
    "sInfoFiltered": "(从 _MAX_ 条数据中检索)",
    "oPaginate": {
      "sFirst": "首页",
      "sPrevious": "前一页",
      "sNext": "后一页",
      "sLast": "尾页"
    },
    "sSearch": "搜索: ",
    "sZeroRecords": "没有检索到数据",
    "sProcessing": "<img src='./loading.gif' />"
  }
});

$.ajax({
  "type": "get",
  "url": "device/register/list",
  "success": function(data) {
    var d, data_list, dd, table_data, tmp, _i, _len;
    console.log(data);
    data_list = data['data'];
    table_data = [];
    for (_i = 0, _len = data_list.length; _i < _len; _i++) {
      d = data_list[_i];
      tmp = [];
      tmp.push("<a href='' class='orange' data-toggle='modal' data-target='#update_user_modal' onclick='update_user(" + d['id'] + ")'>" + d['username'] + "</a>");
      tmp.push(d['loginName']);
      tmp.push(d['passcode']);
      tmp.push(d['snNumber']);
      dd = new Date(d['registionTime']);
      tmp.push([dd.getFullYear(), dd.getMonth() + 1, dd.getDate()].join('-') + ' ' + [dd.getHours(), dd.getMinutes(), dd.getSeconds()].join(':'));
      if (d['enrollment_status'] === '1') {
        tmp.push('<span class="label label-sm label-warning">已激活</span>');
      } else {
        tmp.push('<span class="label label-sm label-success">未激活</span>');
      }
      tmp.push("<td>\n	<div class=\"visible-md visible-lg hidden-sm hidden-xs action-buttons\">\n		<a class=\"blue\" href=\"#\">\n			<i class=\"icon-zoom-in bigger-130\"></i>\n		</a>\n\n		<a class=\"green\" href=\"#\">\n			<i class=\"icon-pencil bigger-130\"></i>\n		</a>\n\n		<a class=\"red\" href=\"#\">\n			<i class=\"icon-trash bigger-130\"></i>\n		</a>\n	</div>\n\n	<div class=\"visible-xs visible-sm hidden-md hidden-lg\">\n		<div class=\"inline position-relative\">\n			<button class=\"btn btn-minier btn-yellow dropdown-toggle\" data-toggle=\"dropdown\">\n				<i class=\"icon-caret-down icon-only bigger-120\"></i>\n			</button>\n\n			<ul class=\"dropdown-menu dropdown-only-icon dropdown-yellow pull-right dropdown-caret dropdown-close\">\n				<li>\n					<a href=\"#\" class=\"tooltip-info\" data-rel=\"tooltip\" title=\"View\">\n						<span class=\"blue\">\n							<i class=\"icon-zoom-in bigger-120\"></i>\n						</span>\n					</a>\n				</li>\n\n				<li>\n					<a href=\"#\" class=\"tooltip-success\" data-rel=\"tooltip\" title=\"Edit\">\n						<span class=\"green\">\n							<i class=\"icon-edit bigger-120\"></i>\n						</span>\n					</a>\n				</li>\n\n				<li>\n					<a href=\"#\" class=\"tooltip-error\" data-rel=\"tooltip\" title=\"Delete\">\n						<span class=\"red\">\n							<i class=\"icon-trash bigger-120\"></i>\n						</span>\n					</a>\n				</li>\n			</ul>\n		</div>\n	</div>\n</td>");
      tmp.push("123");
      table_data.push(tmp);
    }
    console.log(table_data);
    return $("#device_register_list").dataTable().fnAddData(table_data);
  }
});

this.update_user = function(uid) {
  return $.ajax({
    "type": "get",
    "url": "/user/user_info?uid=" + uid,
    "success": function(data) {
      return console.log(data);
    }
  });
};
