// Generated by CoffeeScript 1.7.1
$(function() {
  var seriesOptions;
  seriesOptions = [];
  $.getJSON('/device/register_history', function(data) {
    var status_list_chart, xiaomi_crawled_data, xiaomi_new_data;
    xiaomi_crawled_data = [];
    xiaomi_new_data = [];
    $.each(data, function(date, item) {
      date = date.split('-');
      date = Date.UTC(parseInt(date[0]), parseInt(date[1]) - 1, parseInt(date[2]));
      item = eval('(' + item + ')');
      console.log(item);
      if (item.crawled) {
        xiaomi_crawled_data.push([date, parseInt(item.crawled)]);
      }
      if (item["new"]) {
        xiaomi_new_data.push([date, parseInt(item["new"])]);
      }
      console.log(xiaomi_crawled_data);
      console.log(xiaomi_new_data);
    });
    seriesOptions[0] = {
      name: 'xiaomi_crawled_data',
      data: xiaomi_crawled_data.sort(function(x, y) {
        return x[0] - y[0];
      })
    };
    seriesOptions[1] = {
      name: 'xiaomi_new_data',
      data: xiaomi_new_data.sort(function(x, y) {
        return x[0] - y[0];
      })
    };
    $('#container-status-list').highcharts('StockChart', {
      chart: {},
      rangeSelector: {
        selected: 1
      },
      title: {
        text: '爬虫数据分析'
      },
      legend: {
        enabled: true
      },
      tooltip: {
        pointFormat: '<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b><br/>',
        valueDecimals: 2
      },
      series: seriesOptions
    });
    status_list_chart = $('#container-status-list').highcharts();
  });
});
